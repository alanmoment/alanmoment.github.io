<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  	<meta property="og:title" content=" The Phabricator of docker build &middot;  Hello World!!" />
  	<meta property="og:site_name" content="Hello World!!" />
  	<meta property="og:url" content="http://localhost:1313/post/cooperation/phabricator/the_phabricator_of_docker_build/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2016-04-07T11:36:00Z" />

    
    <meta property="og:article:tag" content="cooperation" />
    
    <meta property="og:article:tag" content="phabricator" />
    
    

  <title>
     The Phabricator of docker build &middot;  Hello World!!
  </title>

    <meta name="description" content="you can do anything you want to do." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="http://localhost:1313/images/favicon.ico">
	  <link rel="apple-touch-icon" href="http://localhost:1313/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="http://localhost:1313/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="http://localhost:1313/css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />


    
      
          <link href="http://localhost:1313/index.xml" rel="alternate" type="application/rss+xml" title="Hello World!!" />
      
      
    
    <meta name="generator" content="Hugo 0.15" />

    <link rel="canonical" href="http://localhost:1313/post/cooperation/phabricator/the_phabricator_of_docker_build/" />

    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://localhost:1313/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://localhost:1313/page/about/">About me</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://localhost:1313/page/project/">Project</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="http://localhost:1313/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="http://localhost:1313/"><img src="http://localhost:1313//images/avatar.jpg" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">The Phabricator of docker build</h1>
        <small>Phabricator 是一套專案管理工具。...</small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2016-04-07T11:36:00Z">
            Apr 7, 2016
          </time>
        
         
          <span class="post-tag small"><a href="http://localhost:1313/tags/cooperation/">#cooperation</a></span>
         
          <span class="post-tag small"><a href="http://localhost:1313/tags/phabricator/">#phabricator</a></span>
         
        </section>
    </header>

    <section class="post-content">
      

<p>Phabricator 是一套專案管理工具。下次補上 Arcanist 的 Code Review</p>

<h1 id="installation-requirements:0264dd348260e4feb990404513754d99">Installation Requirements</h1>

<ul>
<li>docker environment</li>
<li>docker-compose</li>
</ul>

<h1 id="installing:0264dd348260e4feb990404513754d99">Installing</h1>

<p>已將 <a href="https://github.com/alanmoment/phabricator">Phabricator Docker</a> 整理完畢，並且依環境修改 <code>docker-compose.yml</code></p>

<pre><code>$ docker-compose up -d
</code></pre>

<h1 id="登入-phabricator-container:0264dd348260e4feb990404513754d99">登入 Phabricator Container</h1>

<p>Core</p>

<pre><code>$ ./phabricator/bin/config set phabricator.timezone &quot;Asia/Taipei&quot;
$ ./phabricator/bin/config set phabricator.base-uri &quot;http://geniusnet.io:8081/&quot;
$ ./phabricator/bin/config set auth.login-message &quot;&lt;html&gt;&lt;body style='margin: 0px'&gt;&lt;br /&gt;&lt;h1 style='text-align: center'&gt;Hardworking!&lt;/h1&gt;&lt;img style='-webkit-user-select:none; display:block; margin:auto;' src='http://pic.pimg.tw/markleeblog/1383024945-1385249613.jpg?v=1383024946'&gt;&lt;/body&gt;&lt;/html&gt;&quot;
</code></pre>

<p>Storage</p>

<pre><code>$ ./phabricator/bin/config set storage.local-disk.path &quot;/opt/backup/storage/&quot;
$ ./phabricator/bin/config set security.alternate-file-domain &quot;http://YOUR_PHABRICATOR_DOMAIN:8081/&quot;
</code></pre>

<p>Repository 在這邊的設定會影響到，設定 Diffusion 鏡像 Repository 的位置，也會影響到備份。</p>

<pre><code>$ ./phabricator/bin/config set repository.default-local-path &quot;/var/repo/&quot;
</code></pre>

<p>Mail config</p>

<pre><code>$ ./phabricator/bin/config set phpmailer.smtp-host &quot;smtp.gmail.com&quot;
# 如果您已嘗試將 SMTP 伺服器的連接埠設為 465 (適用 SSL) 和 587 (適用 TLS)，但仍無法傳送郵件。
$ ./phabricator/bin/config set phpmailer.smtp-port 465
$ ./phabricator/bin/config set phpmailer.smtp-user &quot;EMAIL_ACCOUNT&quot;
$ ./phabricator/bin/config set phpmailer.smtp-password &quot;PASSWORD&quot;
$ ./phabricator/bin/config set phpmailer.smtp-protocol &quot;ssl&quot;
$ ./phabricator/bin/config set metamta.default-address &quot;EMAIL_ACCOUNT&quot;
$ ./phabricator/bin/config set metamta.domain &quot;YOUR_PHABRICATOR_DOMAIN&quot;
</code></pre>

<p>Show Prototypes</p>

<pre><code>$ ./phabricator/bin/config set phabricator.show-prototypes true
</code></pre>

<p>按照順序啟動</p>

<pre><code>$ docker start phabricator_database phabricator_phabricator
</code></pre>

<p>Daemons restart</p>

<pre><code>$ ./phabricator/bin/phd restart
</code></pre>

<p>無法刪除 Daemons 時試試看。</p>

<pre><code>$ ./phabricator/bin/storage upgrade
</code></pre>

<h1 id="mail:0264dd348260e4feb990404513754d99">Mail</h1>

<p>改變寄送郵件方式</p>

<p><code>Config &gt; Mail &gt; metamta.mail-adapter : PhabricatorMailImplementationPHPMailerAdapter</code></p>

<p>若是在Google Account有不同的登入方式，例如兩段式驗證，會使得SMTP無法正常運作</p>

<h1 id="backup:0264dd348260e4feb990404513754d99">Backup</h1>

<pre><code>$ docker exec -it CONTAINER_ID /bin/sh /opt/phabricator/backup.sh
</code></pre>

<h1 id="profile-settings:0264dd348260e4feb990404513754d99">Profile Settings</h1>

<p>各種與自身相關的設置，包含圖片、SSH Key等等</p>

<h1 id="ssh-public-keys:0264dd348260e4feb990404513754d99">SSH Public Keys</h1>

<p>SSH Public Keys 要提交 arc 必須要先將自己的 key 上傳，或是產出再下載。</p>

<h1 id="email-notice:0264dd348260e4feb990404513754d99">Email Notice</h1>

<p>Email 各種通知的接收管道，可以在此設置</p>

<h1 id="conduit-api-tokens:0264dd348260e4feb990404513754d99">Conduit API Tokens</h1>

<p>Conduit API Tokens 與 arc 或是其他 API 串接時，會在這邊顯示。</p>

<h1 id="conpherence:0264dd348260e4feb990404513754d99">Conpherence</h1>

<p>Conpherence 即時訊息的溝通平台。</p>

<h1 id="panel:0264dd348260e4feb990404513754d99">Panel</h1>

<p>Panel 編輯方便自己使用的目錄。</p>

<h1 id="dashboard:0264dd348260e4feb990404513754d99">Dashboard</h1>

<p>Dashboard 編輯自己快速瀏覽的煮版面。</p>

<h1 id="phriction:0264dd348260e4feb990404513754d99">Phriction</h1>

<p>Phriction 是用來做需求、開發或是規格的記錄文件，採用 Remark 的方式撰寫，試過 Markdown 可以無痛轉移。</p>

<h1 id="pastes:0264dd348260e4feb990404513754d99">Pastes</h1>

<p>Pastes 用來張貼各種語法，透過這個功能可以順利地表達程式碼。</p>

<h1 id="pholio-mock:0264dd348260e4feb990404513754d99">Pholio Mock</h1>

<p>Pholio Mock 運用圖片表達文字無法傳達的意思，可以在圖片上註記要注意或是溝通的事項。</p>

<h1 id="diffusion:0264dd348260e4feb990404513754d99">Diffusion</h1>

<p>新增 Repository 流程</p>

<ol>
<li>Import an Existing External Repository

<ol>
<li>Git</li>
</ol></li>
<li>Choose a human-readable name: PROJECT_NAME</li>
<li>Callsigns must be UPPERCASE: WEB</li>
<li>Enter the URI to clone this Git repository: RESPOSITORY_URL</li>
<li>Add Credential</li>
<li>Create Credential</li>
</ol>

<h1 id="phabulous-notice-for-slack:0264dd348260e4feb990404513754d99">Phabulous (notice for slack)</h1>

<p>已將 Phabulous 的 Docker 整理完畢</p>

<ul>
<li>Ubuntu 14.04 LTS</li>
<li>gvm</li>
<li>go 1.4</li>
</ul>

<h3 id="gvm-go-install:0264dd348260e4feb990404513754d99">GVM &amp; Go Install</h3>

<pre><code>$ bash &lt; &lt;(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)
$ gvm install go1.4
$ gvm use go1.4 [--default]
</code></pre>

<h3 id="library-install:0264dd348260e4feb990404513754d99">Library Install</h3>

<pre><code>$ go get github.com/mitchellh/gox
$ go get github.com/Sirupsen/logrus
$ go get github.com/facebookgo/inject
$ go get github.com/jacobstr/confer
$ go get github.com/codegangsta/cli
$ go get github.com/gin-gonic/gin
$ go get github.com/nlopes/slack
$ go get github.com/etcinit/phabulous
</code></pre>

<h3 id="phabulous-make-start:0264dd348260e4feb990404513754d99">Phabulous make &amp; start</h3>

<p><code>git clone</code> from <a href="https://github.com/etcinit/phabulous">https://github.com/etcinit/phabulous</a></p>

<pre><code>$ make &amp;&amp; ./build/phabulous_linux_amd64 serve
alan@alan-H97M-D3H:~/go/phabulous$ kill -9 8946 &amp;&amp; ./build/phabulous_linux_amd64 serve
DEBU[0000] Logger is debug level.
DEBU[0000] Booted upper layer.
INFO[0000] Starting up the server... (a.k.a. coffee time)
[GIN-debug] [WARNING] Running in &quot;debug&quot; mode. Switch to &quot;release&quot; mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] GET   /                         --&gt; github.com/etcinit/phabulous/app/controllers.*FrontController.(github.com/etcinit/phabulous/app/controllers.getIndex)·fm (3 handlers)
[GIN-debug] GET   /healthcheck              --&gt; github.com/etcinit/phabulous/app/controllers.*FrontController.(github.com/etcinit/phabulous/app/controllers.getHealthCheck)·fm (3 handlers)
[GIN-debug] POST  /v1/feed/receive          --&gt; github.com/etcinit/phabulous/app/controllers.*FeedController.(github.com/etcinit/phabulous/app/controllers.postReceive)·fm (3 handlers)
[GIN-debug] Listening and serving HTTP on :8086
INFO[0000] Starting RTM handler...
DEBU[0000] RTM Event received.
DEBU[0003] RTM Event received.
...省略
</code></pre>

<p>另外要在 Phabricator 設置 feed hooks</p>

<pre><code>$ ./phabricator/bin/config set feed.http-hooks '[&quot;http://YOUR_PHABRICATOR_DOMAIN:8086/v1/feed/receive&quot;]'
</code></pre>

<p>若是有成功送出通知，會有 log 顯示。</p>

<pre><code>DEBU[6417] epoch=1453355944&amp;storyAuthorPHID=PHID-USER-hshw6rbaixcnjaedzhf2&amp;storyData%5BobjectPHID%5D=PHID-DREV-ck47rwvcxhujb7sglbwf&amp;storyData%5BtransactionPHIDs%5D%5BPHID-XACT-DREV-5mu2ffzccqgtwcq%5D=PHID-XACT-DREV-5mu2ffzccqgtwcq&amp;storyData%5BtransactionPHIDs%5D%5BPHID-XACT-DREV-5rnlgp26j6n7jmc%5D=PHID-XACT-DREV-5rnlgp26j6n7jmc&amp;storyData%5BtransactionPHIDs%5D%5BPHID-XACT-DREV-b4mol6ocdcu524s%5D=PHID-XACT-DREV-b4mol6ocdcu524s&amp;storyData%5BtransactionPHIDs%5D%5BPHID-XACT-DREV-uqkmceoz4ja5no6%5D=PHID-XACT-DREV-uqkmceoz4ja5no6&amp;storyID=9&amp;storyText=root+requested+changes+to+D1%3A+add+arcconfig.&amp;storyType=PhabricatorApplicationTransactionFeedStory
[GIN] 2016/01/21 - 13:59:07 | 200 |  1.455306608s | 172.17.0.6:55900 |   POST    /v1/feed/receive
DEBU[6423] RTM Event received.
</code></pre>

<h1 id="scrum-flow:0264dd348260e4feb990404513754d99">Scrum Flow</h1>

<p>可以輸入 store point 最後還有 Burndown chart 可以看</p>

<pre><code>$ ./phabricator/bin/config set load-libraries '{&quot;sprint&quot;:&quot;/opt/libext/sprint/src&quot;}'
$ ln -s /opt/libext/sprint/rsrc/webroot-static /opt/phabricator/webroot/rsrc/sprint
</code></pre>

<h1 id="phabricator-sprint:0264dd348260e4feb990404513754d99">Phabricator-Sprint</h1>

<h1 id="maniphest:0264dd348260e4feb990404513754d99">Maniphest</h1>

<h1 id="task-export-to-excel:0264dd348260e4feb990404513754d99">Task export to Excel</h1>

<p>PHP 必須先支援輸出 Excel</p>

<pre><code># 可以用語法找出include的路徑
print_r(get_include_path());
/opt:.:/usr/share/php:/usr/share/pear

$ git clone https://github.com/PHPOffice/PHPExcel.git /usr/share/php
$ vim /etc/php5/cli/php.ini
# search ;include_path and append
include_path = &quot;.:/usr/share/php:/usr/share/php/PHPExcel/Classes&quot;

$ vim /etc/php5/apache2/php.ini
# search ;include_path and append
include_path = &quot;.:/usr/share/php:/usr/share/php/PHPExcel/Classes&quot;
apachectl restart
</code></pre>

<p>只要支援就可以在 Maniphest 的頁面選擇 Export to Excel</p>

    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="http://localhost:1313/" style="background-image: url(http://localhost:1313//images/avatar.jpg)"><span class="hidden">Alan's Picture</span></a>
    </figure>
    

    





<section class="author">
  <h4><a href="http://localhost:1313/">Alan</a></h4>
  
  <p>Read <a href="http://localhost:1313/">more posts</a> by this author.</p>
  
  <div class="author-meta">
    
    
  </div>
</section>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=The%20Phabricator%20of%20docker%20build&amp;url=http%3a%2f%2flocalhost%3a1313%2fpost%2fcooperation%2fphabricator%2fthe_phabricator_of_docker_build%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fpost%2fcooperation%2fphabricator%2fthe_phabricator_of_docker_build%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2flocalhost%3a1313%2fpost%2fcooperation%2fphabricator%2fthe_phabricator_of_docker_build%2f&amp;description=The%20Phabricator%20of%20docker%20build"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=http%3a%2f%2flocalhost%3a1313%2fpost%2fcooperation%2fphabricator%2fthe_phabricator_of_docker_build%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    

<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'alanmoment';
  var disqus_url = 'http:\/\/localhost:1313\/post\/cooperation\/phabricator\/the_phabricator_of_docker_build\/';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Hello World!!</a> &copy; Copyright Alan - 2016</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="http://localhost:1313/js/jquery.js"></script>
    <script type="text/javascript" src="http://localhost:1313/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="http://localhost:1313/js/index.js"></script>
    
</body>
</html>

